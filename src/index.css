@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Strongly set page background on html/body/#root to override DaisyUI theme defaults if needed */
  html, body, #root { background-color: #fafafa !important; }
  .blocky { font-family: 'Times New Roman', serif; }
}

/* Laboratory grid background */
.grid-bg {
  min-height: 100vh;
  background-color: #fafafa;
  background-image:
    linear-gradient(rgba(0,0,0,0.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.06) 1px, transparent 1px),
    linear-gradient(rgba(0,0,0,0.12) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.12) 1px, transparent 1px);
  background-size:
    20px 20px,
    20px 20px,
    100px 100px,
    100px 100px;
  animation: grid-drift 120s linear infinite;
}

@keyframes grid-drift {
  0% {
    background-position:
      0 0,
      0 0,
      0 0,
      0 0;
  }
  100% {
    background-position:
      8px 8px,
      12px 12px,
      30px 30px,
      45px 45px;
  }
}

/* Ensure main app wrapper is transparent so the page background shows through */
.min-h-screen { background: transparent !important; }

/* Ensure data-theme container at the root does not override page background */
div[data-theme] { background: transparent !important; }

/* Small helper for the Roblox-like thumbnail feel */
.thumbnail-placeholder{ @apply rounded-md h-36 flex items-center justify-center text-white font-bold text-lg; }

/* soften shadows and add warm tint */
.soft-shadow { box-shadow: 0 8px 18px rgba(240,100,120,0.08), 0 2px 6px rgba(0,0,0,0.04); }

/* hover heart/clover next to play */
.card-actions .btn .inline-appear { transition: opacity 220ms ease, transform 220ms ease; opacity: 0; transform: translateY(2px); }
.group:hover .card-actions .btn .inline-appear { opacity: 1; transform: translateY(0); }

/* play button: softer, less jarring */
.play-btn { background: linear-gradient(90deg,#ff9db0,#ffc8d9); color: white; border: none; }
.play-btn:hover { filter: brightness(0.98); }
.play-btn .icon-heart { transition: all 220ms ease; }
.group:hover .play-btn .icon-heart { opacity: 1; transform: translateX(0); }

/* softer subtitle style */
.card-body p.text-rose-600\/80 { font-style: italic; font-weight: 500; }

/* clover subtle backgrounds */
.thumbnail-placeholder img[alt="clover"], .thumbnail-placeholder svg { filter: drop-shadow(0 1px 0 rgba(255,255,255,0.05)); }


/* Relationship Trivia stuff */
/* ---- SPOTLIGHTS (QUIZ CARD) ---- */
.spotlight {
  position: absolute;
  top: -60px;
  width: 200px;
  height: 200px;
  background: radial-gradient(
    ellipse at bottom,
    rgba(255, 182, 193, 0.5),
    transparent 70%
  );
  filter: blur(22px);
  opacity: 0.7;
  z-index: -1;
}

.spotlight.left {
  left: -60px;
  transform: rotate(25deg);
}

.spotlight.right {
  right: -60px;
  transform: rotate(-25deg);
}

/* ---- START SCREEN SPOTLIGHTS ---- */
.start-spotlight {
  position: absolute;
  width: 350px;
  height: 350px;
  background: radial-gradient(
    circle,
    rgba(255, 240, 255, 0.6),
    transparent 70%
  );
  filter: blur(40px);
  opacity: 0.5;
}

/* ---- MARQUEE BORDER (NO SPIN) ---- */
.marquee-border {
  position: relative;
}

.marquee-border::before {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 22px;
  padding: 4px;
  background: conic-gradient(
    #ff7ecd,
    #ffb6e6,
    #cba6ff,
    #93d3ff,
    #ff7ecd
  );
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask-composite: exclude;
  z-index: -1;
  animation: none;
}
.game-title-glow,
.countdown-glow {
  text-shadow:
    0 0 10px rgba(0,0,0,0.55),
    0 0 20px rgba(0,0,0,0.35),
    0 0 30px rgba(0,0,0,0.25);
}

/* Heart bubbles (main menu) - small white pixel hearts that float up and fade */
.main-grid-wrapper { position: relative; z-index: 10; }
.heart-bubbles { position: absolute; top: 0; bottom: 0; width: 12%; pointer-events: none; z-index: 0; }
.heart-bubbles.left { left: -6%; }
.heart-bubbles.right { right: -6%; }
.heart-bubble { position: absolute; bottom: 0; display: block; width: 20px; height: 20px; transform-origin: center bottom; animation-name: heartFloat; animation-timing-function: ease-out; animation-iteration-count: infinite; }
.heart-bubble svg { width: 20px; height: 20px; image-rendering: pixelated; shape-rendering: crispEdges; display: block; }

/* Image-based floating hearts (used by HeartBubbles component) */
.heart-bubble-img { image-rendering: pixelated; -ms-interpolation-mode: nearest-neighbor; pointer-events: none; will-change: transform, opacity; }

@keyframes hbFloat {
  0% { transform: translateY(0) scale(0.9); opacity: 0; }
  8% { opacity: 0.95; }
  60% { transform: translateY(-60vh) scale(1.02); opacity: 0.95; }
  100% { transform: translateY(-140vh) scale(1.08); opacity: 0; }
}

@keyframes heartFloat {
  0% { transform: translateY(0) scale(0.9); opacity: 0; }
  10% { opacity: 0.9; }
  60% { transform: translateY(-110px) scale(1.02); opacity: 0.9; }
  100% { transform: translateY(-160px) scale(1.08); opacity: 0; }
}

/* Confetti burst at top (one-time). Particles use CSS vars for target translation/rotation */
.confetti-container {
  position: fixed;
  top: 8px;
  left: 0;
  right: 0;
  height: 380px; /* allow more vertical travel */
  pointer-events: none;
  z-index: 60;
  overflow: visible;
}
.confetti-particle {
  position: absolute;
  top: 0;
  transform-origin: center;
  width: 28px;
  height: auto;
  will-change: transform, opacity;
  animation-name: confettiBurst;
  animation-timing-function: cubic-bezier(.2,.8,.3,1);
  animation-fill-mode: forwards;
}

@keyframes confettiBurst {
  0% {
    transform: translate(0px, 0px) rotate(0deg) scale(0.8);
    opacity: 1;
  }
  70% {
    transform: translate(var(--tx, 0px), var(--ty, 260px)) rotate(var(--rot, 0deg)) scale(1);
    opacity: 0.95;
  }
  100% {
    transform: translate(calc(var(--tx, 0px) * 1.08), calc(var(--ty, 260px) * 1.5)) rotate(calc(var(--rot, 0deg) * 1.2)) scale(1.04);
    opacity: 0;
  }
}

/* Entry animations for home screen (play only when .home-animate is present on main) */
.home-title, .home-subtitle, .home-grid { opacity: 1; transform: none; }
.home-animate .home-title { opacity: 0; transform: translateY(-12px); animation: titleDrop 2000ms cubic-bezier(.2,.8,.25,1) forwards; animation-delay: 300ms; }
.home-animate .home-subtitle { opacity: 0; transform: translateY(-8px); animation: subtitleFade 2000ms ease forwards; animation-delay: 750ms; }
.home-animate .home-grid { opacity: 0; transform: translateY(12px); animation: gridUp 2200ms cubic-bezier(.2,.8,.25,1) forwards; animation-delay: 1100ms; }

@keyframes titleDrop { to { opacity: 1; transform: translateY(0); } }
@keyframes subtitleFade { to { opacity: 1; transform: translateY(0); } }
@keyframes gridUp { to { opacity: 1; transform: translateY(0); } }

/* Header area music toggle */
.header-area { position: relative; display: block; }
.music-toggle { position: absolute; top: 6px; right: 6px; width: 36px; height: 36px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.06); color: #fff; border: 1px solid rgba(255,255,255,0.06); cursor: pointer; backdrop-filter: blur(4px); }
.music-toggle img { display: block; width: 18px; height: 18px; object-fit: contain; }
.music-toggle.on { background: linear-gradient(90deg,#ffd6e8,#e6e1ff); color: #5b214b; box-shadow: 0 4px 10px rgba(0,0,0,0.12); }
.music-toggle.off { opacity: 0.9; }

/* tilt animation for toggle icon: left then right then settle */
.music-toggle.animating img {
  animation: soundToggle 420ms ease-in-out forwards;
}

@keyframes soundToggle {
  0% { transform: rotate(0deg); }
  20% { transform: rotate(-18deg); }
  60% { transform: rotate(10deg); }
  100% { transform: rotate(0deg); }
}

/* Drafting-board extras: inner glow, trace, tooltip, cursor, annotations, grain, scanline */
.exp-card { cursor: crosshair; position: relative; }
.exp-card .inner-glow {
  position: absolute;
  inset: 0.5rem;
  border-radius: 0;
  background: radial-gradient(circle at 50% 30%, rgba(0,0,0,0.06) 0%, rgba(0,0,0,0.01) 40%, transparent 60%);
  opacity: 0;
  transition: opacity 300ms ease;
  pointer-events: none;
}
.exp-card:hover .inner-glow { opacity: 0.12; }

/* trace outline animation (SVG rect stroke-dash) */
.trace-rect { stroke-dasharray: 1200; stroke-dashoffset: 1200; stroke-opacity: 0.9; }
.group:hover .trace-rect { animation: trace 700ms linear forwards; }
@keyframes trace {
  to { stroke-dashoffset: 0; }
}

/* tooltip that briefly appears then fades when interacting with Access */
.exp-access { position: relative; overflow: visible; }
.exp-access .exp-tooltip {
  position: absolute;
  top: -26px;
  left: 50%;
  transform: translateX(-50%);
  background: transparent;
  color: #000;
  font-size: 10px;
  opacity: 0;
  pointer-events: none;
}
.exp-access:hover .exp-tooltip { animation: tooltip-fade 900ms forwards; }
@keyframes tooltip-fade {
  0% { opacity: 1; transform: translateX(-50%) translateY(0); }
  60% { opacity: 1; }
  100% { opacity: 0; transform: translateX(-50%) translateY(-8px); }
}

/* handwritten margin notes */
.annotations .note {
  position: absolute;
  font-family: 'Segoe Script', 'Brush Script MT', cursive;
  color: rgba(0, 0, 0, 0.15);
  font-size: 12px;
  user-select: none;
}
.annotations .left-note { top: 120px; left: -36px; transform: rotate(-12deg); }
.annotations .right-note { top: 220px; right: -40px; transform: rotate(14deg); }
.annotations .bottom-note { bottom: 80px; left: 60px; transform: rotate(-6deg); }

/* awaiting input dim */
.grid-bg.idle > main { filter: brightness(0.82); transition: filter 600ms ease; }
.awaiting-input { opacity: 0.9; }

/* build flicker */
.build-line.flicker { animation: build-flicker 420ms steps(2, end); }
@keyframes build-flicker { 0% { opacity: 1 } 50% { opacity: 0 } 100% { opacity: 1 } }

/* grain overlay and scanline flicker */
.grid-bg { position: relative; }
.grid-bg::before {
  /* subtle paper grain using radial gradients */
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: radial-gradient(rgba(0,0,0,0.02) 1px, transparent 1px);
  background-size: 3px 3px;
  opacity: 0.18;
  mix-blend-mode: multiply;
}
.grid-bg::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: linear-gradient(rgba(0,0,0,0.02) 1px, transparent 1px);
  background-size: 100% 3px;
  opacity: 0.03;
  animation: scanline-flicker 10s steps(1, end) infinite;
}
@keyframes scanline-flicker {
  0% { opacity: 0.02 }
  4% { opacity: 0.04 }
  6% { opacity: 0.01 }
  100% { opacity: 0.02 }
}


/* ═══════════════════════════════════════════════
   LAB MAIN MENU — neal.fun-inspired redesign
   ═══════════════════════════════════════════════ */

/* ── Layout ── */
.lab-main {
  max-width: 1280px;
  margin: 0 auto;
  padding: 3rem 2rem 5rem;
  position: relative;
  min-height: 100vh;
}

/* ── Header ── */
.lab-header {
  text-align: center;
  margin-bottom: 2.5rem;
  position: relative;
}
.lab-eyebrow {
  font-family: 'Courier New', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.22em;
  color: #888;
  text-transform: uppercase;
  margin-bottom: 0.75rem;
}
.lab-wordmark {
  font-family: 'Times New Roman', serif;
  font-size: clamp(3.5rem, 9vw, 6.5rem);
  font-weight: 900;
  letter-spacing: 0.06em;
  line-height: 1;
  color: #1a1a1a;
  text-transform: uppercase;
  margin-bottom: 0.9rem;
}
.lab-desc {
  font-family: 'Courier New', monospace;
  font-size: 0.68rem;
  letter-spacing: 0.14em;
  color: #666;
  text-transform: uppercase;
  margin-bottom: 0.6rem;
}
.lab-buildrow {
  font-family: 'Courier New', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.14em;
  color: #aaa;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.6rem;
}
.lab-buildrow.flicker { animation: build-flicker 420ms steps(2, end); }
.lab-sep-dot { color: #ccc; }

.lab-rule {
  width: 100%;
  height: 1px;
  background: #1a1a1a;
  margin-bottom: 3rem;
}

/* ── Sys status badge (top right) ── */
.lab-sys-badge {
  position: absolute;
  top: 1.2rem;
  right: 1.5rem;
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #666;
  display: flex;
  align-items: center;
  gap: 0.4rem;
  z-index: 10;
}
.lab-sys-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #1a1a1a;
  animation: sys-pulse 3s ease-in-out infinite;
}
@keyframes sys-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.25; }
}

/* ── Module grid ── */
.lab-grid {
  display: grid;
  grid-template-columns: repeat(1, 1fr);
  gap: 1.25rem;
}
@media (min-width: 540px)  { .lab-grid { grid-template-columns: repeat(2, 1fr); } }
@media (min-width: 900px)  { .lab-grid { grid-template-columns: repeat(3, 1fr); } }
@media (min-width: 1200px) { .lab-grid { grid-template-columns: repeat(4, 1fr); } }

/* ── Footer ── */
.lab-footer {
  margin-top: 4rem;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  gap: 0.5rem;
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.16em;
  color: #bbb;
  text-transform: uppercase;
}

/* ── Idle overlay ── */
.lab-idle-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  font-family: 'Courier New', monospace;
  font-size: 0.75rem;
  letter-spacing: 0.25em;
  color: rgba(0, 0, 0, 0.35);
  text-transform: uppercase;
}
.lab-blink {
  animation: lab-blink-anim 1s step-start infinite;
}
@keyframes lab-blink-anim {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* ── Idle dim ── */
.grid-bg.idle .lab-main { filter: brightness(0.82); transition: filter 600ms ease; }


/* ═══════════════════════════════════════════════
   MODULE CARD — new design
   ═══════════════════════════════════════════════ */

.module-card {
  background: #fff;
  border: 1px solid #1a1a1a;
  position: relative;
  cursor: crosshair;
  transition: transform 180ms ease, box-shadow 180ms ease;
  display: flex;
  flex-direction: column;
}
.module-card:hover {
  transform: translateY(-3px);
  box-shadow: 4px 4px 0 #1a1a1a;
}
.module-card:active {
  transform: translateY(0px);
  box-shadow: 1px 1px 0 #1a1a1a;
}

/* Card top row */
.module-card-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 0.7rem 0.35rem;
}
.module-id-tag {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.16em;
  color: #999;
  text-transform: uppercase;
}
.module-led {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: #d0d0d0;
  border: 1px solid #bbb;
  transition: background 200ms ease, box-shadow 200ms ease;
}
.module-card:hover .module-led {
  background: #e8c940;
  border-color: #c4a820;
  box-shadow: 0 0 5px rgba(232, 201, 64, 0.75);
}

/* Thumbnail */
.module-thumb-wrap {
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  overflow: hidden;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
  background: #eeebe5;
}
.module-thumb-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: transform 320ms ease;
}
.module-card:hover .module-thumb-img {
  transform: scale(1.04);
}
.module-thumb-empty {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Courier New', monospace;
  font-size: 0.65rem;
  color: #bbb;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

/* Card body */
.module-body {
  padding: 0.7rem 0.75rem 0.4rem;
  flex: 1;
}
.module-sep {
  width: 100%;
  height: 1px;
  background: #e8e8e8;
  margin-bottom: 0.55rem;
}
.module-title-text {
  font-family: 'Times New Roman', serif;
  font-size: 0.88rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: #1a1a1a;
  line-height: 1.3;
  margin-bottom: 0.3rem;
}
.module-tagline-text {
  font-family: 'Times New Roman', serif;
  font-size: 0.7rem;
  color: #888;
  font-style: italic;
  line-height: 1.45;
}

/* Card action */
.module-foot {
  padding: 0.45rem 0.75rem 0.7rem;
}
.module-btn {
  display: block;
  width: 100%;
  text-align: center;
  font-family: 'Courier New', monospace;
  font-size: 0.62rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #1a1a1a;
  border: 1px solid #1a1a1a;
  padding: 0.4rem 0.75rem;
  text-decoration: none;
  background: transparent;
  transition: background 140ms ease, color 140ms ease;
}
.module-btn:hover {
  background: #1a1a1a;
  color: #fff;
}
.module-btn:active {
  background: #000;
  color: #fff;
}
.module-btn-arrow {
  display: inline-block;
  transition: transform 140ms ease;
}
.module-btn:hover .module-btn-arrow {
  transform: translateX(4px);
}


/* ═══════════════════════════════════════════════
   CRYPTOGRAM PAGE
   ═══════════════════════════════════════════════ */

/* ── Page wrapper ── */
.crypto-page {
  min-height: 100vh;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 3rem 1rem 5rem;
}

/* ── Main panel ── */
.crypto-panel {
  background: #fff;
  border: 1px solid #1a1a1a;
  max-width: 760px;
  width: 100%;
}

/* ── Header ── */
.crypto-header {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 1rem;
  padding: 0.85rem 1rem;
}
.crypto-back {
  font-family: 'Courier New', monospace;
  font-size: 0.62rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #1a1a1a;
  text-decoration: none;
  border: 1px solid #1a1a1a;
  padding: 0.3rem 0.6rem;
  white-space: nowrap;
  transition: background 140ms ease, color 140ms ease;
}
.crypto-back:hover {
  background: #1a1a1a;
  color: #fff;
}
.crypto-header-center {
  text-align: center;
}
.crypto-eyebrow {
  font-family: 'Courier New', monospace;
  font-size: 0.55rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #999;
  margin-bottom: 0.2rem;
}
.crypto-title {
  font-family: 'Times New Roman', serif;
  font-size: clamp(1.6rem, 4vw, 2.4rem);
  font-weight: 900;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #1a1a1a;
  line-height: 1;
}
.crypto-header-led {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #e8c940;
  border: 1px solid #c4a820;
  box-shadow: 0 0 5px rgba(232, 201, 64, 0.7);
  animation: sys-pulse 3s ease-in-out infinite;
  flex-shrink: 0;
}

/* ── Divider ── */
.crypto-rule {
  width: 100%;
  height: 1px;
  background: #1a1a1a;
}

/* ── Controls ── */
.crypto-controls {
  padding: 0.85rem 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}
.crypto-ctrl-row {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
}
.crypto-ctrl-label {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: #999;
  width: 72px;
  flex-shrink: 0;
}
.crypto-toggle-group {
  display: flex;
  gap: 0.35rem;
  flex-wrap: wrap;
}
.crypto-toggle {
  font-family: 'Courier New', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #666;
  background: transparent;
  border: 1px solid #ccc;
  padding: 0.25rem 0.65rem;
  cursor: pointer;
  transition: border-color 120ms ease, background 120ms ease, color 120ms ease;
}
.crypto-toggle:hover {
  border-color: #1a1a1a;
  color: #1a1a1a;
}
.crypto-toggle.on {
  background: #1a1a1a;
  color: #fff;
  border-color: #1a1a1a;
}

/* ── Puzzle cells ── */
.crypto-cells-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 5px 6px;
  padding: 1.5rem 1rem;
  justify-content: center;
}
.crypto-space {
  width: 14px;
}
.crypto-punct {
  font-family: 'Times New Roman', serif;
  font-size: 1rem;
  color: #555;
  align-self: flex-end;
  padding-bottom: 5px;
}
.crypto-cell {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 30px;
  cursor: pointer;
  border: 1px solid #d0d0d0;
  transition: border-color 120ms ease, background 120ms ease;
  user-select: none;
}
.crypto-cell:hover {
  border-color: #888;
}
.crypto-cell.active {
  border-color: #1a1a1a;
  background: #1a1a1a;
}
.crypto-cell.correct {
  border-color: #1a1a1a;
}
.crypto-cell-guess {
  height: 22px;
  width: 100%;
  font-family: 'Courier New', monospace;
  font-size: 0.78rem;
  font-weight: 700;
  color: #1a1a1a;
  display: flex;
  align-items: center;
  justify-content: center;
  letter-spacing: 0;
}
.crypto-cell.active .crypto-cell-guess {
  color: #fff;
}
.crypto-cell-divider {
  width: 100%;
  height: 1px;
  background: #d0d0d0;
}
.crypto-cell.active .crypto-cell-divider {
  background: #555;
}
.crypto-cell-code {
  height: 15px;
  width: 100%;
  font-family: 'Courier New', monospace;
  font-size: 0.52rem;
  color: #aaa;
  display: flex;
  align-items: center;
  justify-content: center;
}
.crypto-cell.active .crypto-cell-code {
  color: #888;
}
.crypto-cell.correct .crypto-cell-code {
  color: #888;
}

/* ── Keyboard ── */
.crypto-keyboard {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  padding: 1rem 1rem;
}
.crypto-key-row {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  justify-content: center;
}
.crypto-key {
  width: 32px;
  height: 32px;
  font-family: 'Courier New', monospace;
  font-size: 0.65rem;
  font-weight: 600;
  letter-spacing: 0.05em;
  color: #1a1a1a;
  background: #fff;
  border: 1px solid #1a1a1a;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 120ms ease, color 120ms ease;
}
.crypto-key:hover {
  background: #1a1a1a;
  color: #fff;
}
.crypto-key:active {
  background: #000;
  color: #fff;
  transform: scale(0.93);
}
.crypto-key.ctrl {
  width: auto;
  padding: 0 10px;
  min-width: 36px;
}

/* ── Actions row ── */
.crypto-actions {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  padding: 1rem;
  flex-wrap: wrap;
}
.crypto-action-btn {
  font-family: 'Courier New', monospace;
  font-size: 0.62rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #1a1a1a;
  background: transparent;
  border: 1px solid #1a1a1a;
  padding: 0.4rem 1rem;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  transition: background 140ms ease, color 140ms ease;
}
.crypto-action-btn:hover {
  background: #1a1a1a;
  color: #fff;
}
.crypto-action-btn:active {
  background: #000;
  color: #fff;
}
.crypto-reveal-count {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #aaa;
}

/* ── Loading ── */
.crypto-loading {
  padding: 3rem 1rem;
  text-align: center;
  font-family: 'Courier New', monospace;
  font-size: 0.68rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: #888;
}

/* ── Solved overlay ── */
.crypto-solved-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
}
.crypto-solved-panel {
  background: #f8f7f4;
  border: 2px solid #1a1a1a;
  padding: 2rem 2.5rem;
  max-width: 520px;
  width: 90%;
  text-align: center;
  position: relative;
  z-index: 51;
}
.crypto-solved-eyebrow {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #999;
  margin-bottom: 0.4rem;
}
.crypto-solved-title {
  font-family: 'Times New Roman', serif;
  font-size: 2rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: #1a1a1a;
  margin-bottom: 1rem;
}
.crypto-solved-phrase {
  font-family: 'Times New Roman', serif;
  font-size: 0.95rem;
  font-style: italic;
  color: #555;
  line-height: 1.6;
  margin: 1rem 0;
}
.crypto-solved-meta {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #bbb;
  margin-bottom: 1rem;
}
.crypto-solved-actions {
  display: flex;
  gap: 0.75rem;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 1.25rem;
}


/* ═══════════════════════════════════════════════
   BREAKOUT PAGE
   ═══════════════════════════════════════════════ */

/* ── Panel ── */
.bb-panel {
  background: #fff;
  border: 1px solid #1a1a1a;
  max-width: 560px;
  width: 100%;
}

/* ── Status bar ── */
.bb-status {
  display: flex;
  align-items: center;
  gap: 1.25rem;
  padding: 0.55rem 1rem;
  flex-wrap: wrap;
}
.bb-stat-group {
  display: flex;
  align-items: center;
  gap: 0.4rem;
}
.bb-stat-label {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #999;
}
.bb-stat-val {
  font-family: 'Courier New', monospace;
  font-size: 0.72rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  color: #1a1a1a;
}
.bb-lives {
  display: flex;
  align-items: center;
  gap: 3px;
}
.bb-life-pip {
  width: 18px;
  height: 18px;
  object-fit: contain;
  display: block;
}
.bb-ctrl-group {
  display: flex;
  gap: 0.35rem;
  margin-left: auto;
  flex-wrap: wrap;
}
.bb-toggle {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #777;
  background: transparent;
  border: 1px solid #ccc;
  padding: 0.25rem 0.6rem;
  cursor: pointer;
  transition: border-color 120ms ease, background 120ms ease, color 120ms ease;
}
.bb-toggle:hover {
  border-color: #1a1a1a;
  color: #1a1a1a;
}
.bb-toggle.on {
  background: #1a1a1a;
  color: #fff;
  border-color: #1a1a1a;
}

/* ── Mutation countdown ── */
.bb-countdown {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: #aaa;
  padding: 0.2rem 1rem 0.3rem;
}

/* ── Per-mutation indicator ── */
.bb-mutation-bar {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.35rem 1rem;
  font-family: 'Courier New', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--mut-color, #e8c940);
  background: color-mix(in srgb, var(--mut-color, #e8c940) 8%, transparent);
  border-top: 1px solid color-mix(in srgb, var(--mut-color, #e8c940) 35%, transparent);
  border-bottom: 1px solid color-mix(in srgb, var(--mut-color, #e8c940) 35%, transparent);
  animation: bb-mut-pulse 1.8s ease-in-out infinite;
}
.bb-mut-warn {
  font-weight: 900;
  font-size: 0.75rem;
  line-height: 1;
}
@keyframes bb-mut-pulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.6; }
}

/* ── Canvas wrapper ── */
.bb-canvas-wrap {
  position: relative;
  background: #0d0d12;
  display: block;
  line-height: 0; /* remove inline gap under canvas */
}
.bb-canvas {
  display: block;
  width: 100%;
  height: auto;
  cursor: crosshair;
}

/* ── Glitch animation (triggered on mutation) ── */
@keyframes bb-glitch {
  0%   { transform: translate(0, 0)     skewX(0deg);    filter: none;                    opacity: 1;    }
  12%  { transform: translate(-5px, 2px) skewX(-1.8deg); filter: hue-rotate(25deg) brightness(1.4); opacity: 0.88; }
  25%  { transform: translate(4px, -2px) skewX(0.8deg);  filter: hue-rotate(-20deg);      opacity: 0.92; }
  37%  { transform: translate(-3px, 0)  skewX(0deg);    filter: brightness(1.25);        opacity: 1;    }
  50%  { transform: translate(5px, 1px) skewX(-1deg);   filter: none;                    opacity: 0.85; }
  62%  { transform: translate(-2px,-1px) skewX(0.5deg);  filter: hue-rotate(12deg);       opacity: 0.95; }
  75%  { transform: translate(3px, 2px) skewX(0deg);    filter: brightness(1.15);        opacity: 1;    }
  88%  { transform: translate(-1px, 0)  skewX(-0.5deg); filter: none;                    opacity: 0.97; }
  100% { transform: translate(0, 0)     skewX(0deg);    filter: none;                    opacity: 1;    }
}
.bb-glitch {
  animation: bb-glitch 0.55s steps(4, end) forwards;
}

/* ── Life-lost flash ── */
.bb-flash-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: #e8c940;
  background: rgba(13, 13, 18, 0.72);
  pointer-events: none;
  animation: bb-flash-fade 1.2s ease-out forwards;
}
@keyframes bb-flash-fade {
  0%   { opacity: 0; }
  15%  { opacity: 1; }
  70%  { opacity: 1; }
  100% { opacity: 0; }
}

/* ── Game-over overlay ── */
.bb-end-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: rgba(13, 13, 18, 0.92);
  z-index: 20;
  padding: 2rem;
  text-align: center;
}
.bb-end-eyebrow {
  font-family: 'Courier New', monospace;
  font-size: 0.58rem;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  color: #666;
  margin-bottom: 0.4rem;
}
.bb-end-title {
  font-family: 'Times New Roman', serif;
  font-size: 2.2rem;
  font-weight: 900;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #f0f0ee;
  margin-bottom: 0.75rem;
}
.bb-end-rule {
  max-width: 180px;
  background: #333;
  margin: 0 auto 0.75rem;
}
.bb-end-score {
  font-family: 'Courier New', monospace;
  font-size: 0.75rem;
  letter-spacing: 0.16em;
  color: #e8c940;
  margin-bottom: 1.25rem;
}
.bb-end-actions {
  display: flex;
  gap: 0.75rem;
  justify-content: center;
  flex-wrap: wrap;
}
/* Invert button colours for dark overlay */
.bb-end-overlay .crypto-action-btn {
  color: #f0f0ee;
  border-color: #f0f0ee;
}
.bb-end-overlay .crypto-action-btn:hover {
  background: #f0f0ee;
  color: #0d0d12;
}

/* ── Instructions ── */
.bb-instructions {
  font-family: 'Courier New', monospace;
  font-size: 0.55rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #bbb;
  text-align: center;
  padding: 0.55rem 1rem 0.7rem;
}
